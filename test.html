<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>jsPDF с вводом текста</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
  <label for="lang">Выберите язык:</label>
  <select id="lang">
    <option value="en">English</option>
    <option value="ru">Русский</option>
  </select>
  <br><br>
  <label for="input-text">Введите текст для PDF:</label>
  <input type="text" id="input-text" placeholder="Введите текст..." />
  <br><br>
  <button id="make">Сгенерировать PDF</button>

  <script>
    document.getElementById("make").addEventListener("click", async () => {
      const { jsPDF } = window.jspdf;
      const lang = document.getElementById("lang").value;
      const userText = document.getElementById("input-text").value.trim();

      if (!userText) {
        alert("Введите текст для PDF!");
        return;
      }

      // Ссылки на картинки для разных языков
      const backgrounds = {
        en: "https://picsum.photos/1200/800?grayscale",
        ru: "https://picsum.photos/1200/800?blur"
      };

      const bgUrl = backgrounds[lang];

      // Создаём документ A4, альбомная ориентация
      const doc = new jsPDF({
        orientation: "landscape",
        unit: "mm",
        format: "a4"
      });

      const pageWidth = doc.internal.pageSize.getWidth();
      const pageHeight = doc.internal.pageSize.getHeight();

      // Загружаем выбранную картинку
      const img = await loadImage(bgUrl);

      doc.addImage(img, "JPEG", 0, 0, pageWidth, pageHeight);

      // Текст по центру
      doc.setFontSize(32);
      doc.setTextColor(255, 255, 255);
      doc.setFont("helvetica", "bold");

      const textWidth = doc.getTextWidth(userText);

      doc.text(
        userText,
        (pageWidth - textWidth) / 2,
        pageHeight / 2,
        { baseline: "middle" }
      );

      doc.save(`example_${lang}.pdf`);
    });

    function loadImage(url) {
      return new Promise((resolve, reject) => {
        const img = new Image();
        img.crossOrigin = "Anonymous";
        img.onload = () => {
          const canvas = document.createElement("canvas");
          canvas.width = img.width;
          canvas.height = img.height;
          const ctx = canvas.getContext("2d");
          ctx.drawImage(img, 0, 0);
          resolve(canvas.toDataURL("image/jpeg"));
        };
        img.onerror = reject;
        img.src = url;
      });
    }
  </script>
</body>
</html>
